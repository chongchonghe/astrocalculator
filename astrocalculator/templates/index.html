<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AstroCalculator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const textarea = document.getElementById('calculation');
            textarea.addEventListener('keydown', function(event) {
                if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {
                    event.preventDefault(); // Prevent default behavior
                    document.querySelector('form').submit(); // Submit the form
                }
            });

            // Function to copy text to clipboard
            function copyToClipboard(text) {
                navigator.clipboard.writeText(text).catch(err => {
                    console.error('Could not copy text: ', err);
                });
            }

            // Add event listeners to result elements
            const resultElements = document.querySelectorAll('.result-copy');
            resultElements.forEach(element => {
                element.addEventListener('click', function() {
                    copyToClipboard(this.textContent);
                });
            });

            // Collapsible functionality
            const coll = document.getElementsByClassName("collapsible");
            for (let i = 0; i < coll.length; i++) {
                coll[i].addEventListener("click", function() {
                    this.classList.toggle("active");
                    const content = this.nextElementSibling;
                    if (content.style.display === "block") {
                        content.style.display = "none";
                    } else {
                        content.style.display = "block";
                    }
                });
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <h1>AstroCalculator</h1>
        <form method="post">
            <label for="calculation">Enter calculation:</label>
            <textarea id="calculation" name="calculation" rows="5" style="resize: vertical;" required>{{ calculation if calculation else '' }}</textarea>
            <p>User units: <input type="text" id="user_units" name="user_units" value="{{ user_units if user_units else '' }}"></p>
            <button type="submit" class="mt-1">Calculate</button>
        </form>
        {% if parsed_input %}
        <div class="result">
            <h2>Results</h2>
            <p><strong>Parsed Input:</strong> <span class="result-copy">{{ parsed_input }}</span></p>
            <p><strong>Result (SI):</strong> <span class="result-copy">{{ result_si }}</span></p>
            <p><strong>Result (cgs):</strong> <span class="result-copy">{{ result_cgs }}</span></p>
            <p><strong>Result (user):</strong> <span class="result-copy">{{ result_user_units }}</span></p>
        </div>
        {% endif %}

        <!-- Addition of the Example Inputs section -->
        <div class="examples">
            <h2>Example Inputs</h2>
            <pre><code>m_p</code></pre>
            <pre><code>m_e c^2</code></pre>
            <pre><code>M = 1.4 M_sun
R = 10 km
v = sqrt(G M / R)
v</code></pre>
            <pre><code>lam = 9 mm
D = 30 m
1.22 lam / D
User units: arcmin</code></pre>
        </div>

        <!-- Updated Constants section with improved toggle button -->
        <div class="constants">
            <h2>Constants and Units</h2>
            <button class="collapsible">
                Show/Hide <span class="toggle-symbol">&#9658;</span>
            </button>
            <div class="content">
                <p>Available constants:</p>
<pre><code>
========== ============== ================ =========================
   Name        Value            Unit       Description
========== ============== ================ =========================
    G       6.674300e-08    cm3 / (g s2)   Gravitational constant
   N_A      6.022141e+23      1 / mol      Avogadro's number
    R       8.314463e+07   erg / (K mol)   Gas constant
   Ryd      1.097373e+05       1 / cm      Rydberg constant
    a0      5.291772e-09         cm        Bohr radius
  alpha     7.297353e-03                   Fine-structure constant
   atm      1.013250e+06       P / s       Standard atmosphere
  b_wien    2.897772e-01        cm K       Wien wavelength displacement law constant
    c       2.997925e+10       cm / s      Speed of light in vacuum
    g0      9.806650e+02      cm / s2      Standard acceleration of gravity
    h       6.626070e-27       erg s       Planck constant
   hbar     1.054572e-27       erg s       Reduced Planck constant
   k_B      1.380649e-16      erg / K      Boltzmann constant
   m_e      9.109384e-28         g         Electron mass
   m_n      1.674927e-24         g         Neutron mass
   m_p      1.672622e-24         g         Proton mass
 sigma_T    6.652459e-25        cm2        Thomson scattering cross-section
 sigma_sb   5.670374e-05    g / (K4 s3)    Stefan-Boltzmann constant
    u       1.660539e-24         g         Atomic mass
 GM_earth   3.986004e+20      cm3 / s2     Nominal Earth mass parameter
  GM_jup    1.266865e+23      cm3 / s2     Nominal Jupiter mass parameter
  GM_sun    1.327124e+26      cm3 / s2     Nominal solar mass parameter
  L_bol0    3.012800e+35      erg / s      Luminosity for absolute bolometric magnitude 0
  L_sun     3.828000e+33      erg / s      Nominal solar luminosity
 M_earth    5.972168e+27         g         Earth mass
  M_jup     1.898125e+30         g         Jupiter mass
  M_sun     1.988410e+33         g         Solar mass
 R_earth    6.378100e+08         cm        Nominal Earth equatorial radius
  R_jup     7.149200e+09         cm        Nominal Jupiter equatorial radius
  R_sun     6.957000e+10         cm        Nominal solar radius
    au      1.495979e+13         cm        Astronomical Unit
   kpc      3.085678e+21         cm        Kiloparsec
    pc      3.085678e+18         cm        Parsec
========== ============== ================ =========================
</code></pre>
                <p>Available units:</p>
<pre><code>
{
  'Length': ['m', 'cm', 'mm', 'um', 'nm', 'Angstrom', 'km', 'au', 'AU', 'pc', 'kpc', 'Mpc', 'lyr',],
  'Mass': ['kg', 'g', 'M_sun', 'Msun'],
  'Density': ['mpcc'],
  'Time': ['s', 'yr', 'Myr', 'Gyr',],
  'Energy': ['J', 'erg', 'eV', 'keV', 'MeV', 'GeV'],
  'Power': ['W'],
  'Pressure': ['Pa', 'bar', 'mbar'],
  'Frequency': ['Hz', 'kHz', 'MHz', 'GHz',],
  'EM': ['esu', 'Gauss'],
  'Temperature': ['K',],
  'Angular size': ['deg', 'radian', 'arcmin', 'arcsec', 'arcsec2', 'sr'],
  'Astronomy': ['Lsun', 'Jy', 'mJy', 'MJy', 'a_rad'],
  'Composite': ['m2', 'm3', 'cm2', 'cm3', 's2', 'pc2', 'pc3']
}
</code></pre>
            </div>
        </div>
    </div>

    <!-- Addition of the Footer section with CopyRight and Feedback button -->
    <footer>
        <p>&copy; 2024 ChongChong He.</p>
        <a href="mailto:chongchong.he@anu.edu.au">
            <button id="feedback-button">ðŸ’¬ Feedback</button>
        </a>
    </footer>
</body>
</html>